<!doctype html>



  


<html class="theme-next pisces use-motion">
<head>
  <meta charset="UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=edge,chrome=1" />
<meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1"/>



<meta http-equiv="Cache-Control" content="no-transform" />
<meta http-equiv="Cache-Control" content="no-siteapp" />












  
  
  <link href="/lib/fancybox/source/jquery.fancybox.css?v=2.1.5" rel="stylesheet" type="text/css" />




  
  
  
  

  
    
    
  

  

  

  

  

  
    
    
    <link href="//fonts.googleapis.com/css?family=Lato:300,300italic,400,400italic,700,700italic&subset=latin,latin-ext" rel="stylesheet" type="text/css">
  






<link href="/lib/font-awesome/css/font-awesome.min.css?v=4.4.0" rel="stylesheet" type="text/css" />

<link href="/css/main.css?v=5.0.1" rel="stylesheet" type="text/css" />


  <meta name="keywords" content="Hexo, NexT" />








  <link rel="shortcut icon" type="image/x-icon" href="/favicon.ico?v=5.0.1" />






<meta property="og:type" content="website">
<meta property="og:title" content="路途">
<meta property="og:url" content="http://yoursite.com/index.html">
<meta property="og:site_name" content="路途">
<meta name="twitter:card" content="summary">
<meta name="twitter:title" content="路途">



<script type="text/javascript" id="hexo.configuration">
  var NexT = window.NexT || {};
  var CONFIG = {
    scheme: 'Pisces',
    sidebar: {"position":"left","display":"post"},
    fancybox: true,
    motion: true,
    duoshuo: {
      userId: 0,
      author: '博主'
    }
  };
</script>

  <title> 路途 </title>
</head>

<body itemscope itemtype="http://schema.org/WebPage" lang="zh-Hans">

  










  
  
    
  

  <div class="container one-collumn sidebar-position-left 
   page-home 
 ">
    <div class="headband"></div>

    <header id="header" class="header" itemscope itemtype="http://schema.org/WPHeader">
      <div class="header-inner"><div class="site-meta ">
  

  <div class="custom-logo-site-title">
    <a href="/"  class="brand" rel="start">
      <span class="logo-line-before"><i></i></span>
      <span class="site-title">路途</span>
      <span class="logo-line-after"><i></i></span>
    </a>
  </div>
  <p class="site-subtitle"></p>
</div>

<div class="site-nav-toggle">
  <button>
    <span class="btn-bar"></span>
    <span class="btn-bar"></span>
    <span class="btn-bar"></span>
  </button>
</div>

<nav class="site-nav">
  

  
    <ul id="menu" class="menu">
      
        
        <li class="menu-item menu-item-home">
          <a href="/" rel="section">
            
              <i class="menu-item-icon fa fa-fw fa-home"></i> <br />
            
            首页
          </a>
        </li>
      
        
        <li class="menu-item menu-item-categories">
          <a href="/categories" rel="section">
            
              <i class="menu-item-icon fa fa-fw fa-th"></i> <br />
            
            分类
          </a>
        </li>
      
        
        <li class="menu-item menu-item-about">
          <a href="/about" rel="section">
            
              <i class="menu-item-icon fa fa-fw fa-user"></i> <br />
            
            关于
          </a>
        </li>
      
        
        <li class="menu-item menu-item-archives">
          <a href="/archives" rel="section">
            
              <i class="menu-item-icon fa fa-fw fa-archive"></i> <br />
            
            所有文章
          </a>
        </li>
      

      
    </ul>
  

  
</nav>

 </div>
    </header>

    <main id="main" class="main">
      <div class="main-inner">
        <div class="content-wrap">
          <div id="content" class="content">
            
  <section id="posts" class="posts-expand">
    
      

  
  

  
  
  

  <article class="post post-type-normal " itemscope itemtype="http://schema.org/Article">

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">
            
            
              
                
                <a class="post-title-link" href="/2016/12/22/9-暂定结构 命令行  exits/" itemprop="url">
                  我也想写厉害的工具 -大体结构 shell exits
                </a>
              
            
          </h1>
        

        <div class="post-meta">
          <span class="post-time">
            <span class="post-meta-item-icon">
              <i class="fa fa-calendar-o"></i>
            </span>
            <span class="post-meta-item-text">发表于</span>
            <time itemprop="dateCreated" datetime="2016-12-22T02:43:56+08:00" content="2016-12-22">
              2016-12-22
            </time>
          </span>

          
            <span class="post-category" >
              &nbsp; | &nbsp;
              <span class="post-meta-item-icon">
                <i class="fa fa-folder-o"></i>
              </span>
              <span class="post-meta-item-text">分类于</span>
              
                <span itemprop="about" itemscope itemtype="https://schema.org/Thing">
                  <a href="/categories/我也想写厉害的工具/" itemprop="url" rel="index">
                    <span itemprop="name">我也想写厉害的工具</span>
                  </a>
                </span>

                
                

              
            </span>
          

          
            
          

          

          
          

          
        </div>
      </header>
    


    <div class="post-body" itemprop="articleBody">

      
      

      
        
          
            <p>这篇讲的是用python实现一个简单的shell。</p>

          
        
      
    </div>

    <div>
      
    </div>

    <div>
      
    </div>

    <footer class="post-footer">
      

      

      
      
        <div class="post-eof"></div>
      
    </footer>
  </article>


    
      

  
  

  
  
  

  <article class="post post-type-normal " itemscope itemtype="http://schema.org/Article">

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">
            
            
              
                
                <a class="post-title-link" href="/2016/12/19/8-云安全（1）-概况 以及同驻攻击、侧信道相关/" itemprop="url">
                  云安全 -概况 以及同驻攻击、侧信道介绍
                </a>
              
            
          </h1>
        

        <div class="post-meta">
          <span class="post-time">
            <span class="post-meta-item-icon">
              <i class="fa fa-calendar-o"></i>
            </span>
            <span class="post-meta-item-text">发表于</span>
            <time itemprop="dateCreated" datetime="2016-12-19T02:43:56+08:00" content="2016-12-19">
              2016-12-19
            </time>
          </span>

          
            <span class="post-category" >
              &nbsp; | &nbsp;
              <span class="post-meta-item-icon">
                <i class="fa fa-folder-o"></i>
              </span>
              <span class="post-meta-item-text">分类于</span>
              
                <span itemprop="about" itemscope itemtype="https://schema.org/Thing">
                  <a href="/categories/论文总结-翻译/" itemprop="url" rel="index">
                    <span itemprop="name">论文总结/翻译</span>
                  </a>
                </span>

                
                

              
            </span>
          

          
            
          

          

          
          

          
        </div>
      </header>
    


    <div class="post-body" itemprop="articleBody">

      
      

      
        
          
            <h2 id="云安全分类"><a href="#云安全分类" class="headerlink" title="云安全分类"></a>云安全分类</h2><p>从层次上看，云安全可以分为以下几类：<br><strong>物理安全</strong><br><strong>虚拟化安全</strong><br><strong>数据安全</strong><br><strong>应用安全</strong></p>
<p>针对虚拟化架构的攻击手段有比如虚拟机逃逸、VM Hopping等。<br>本文主要调研虚拟化安全中的同驻攻击，也涉及到侧信道。所有内容大部分来自最后提到的三篇参考文献。</p>
<h2 id="概念-如何攻击"><a href="#概念-如何攻击" class="headerlink" title="概念/如何攻击"></a>概念/如何攻击</h2><p>物理资源的共享导致云中存在不可避免的安全问题。</p>
<p>一种普遍的思路是这样的：如果攻击者能够让自己的VM被分配到和受害者相同的物理服务器，也就是使两个虚拟机同驻，那么攻击者就可能绕过虚拟机之间的隔离措施，窃取受害者机密信息。</p>
<p>在这个思路中，整个过程包括两个步骤：同驻攻击和跨VM攻击。只有成功实施了同驻攻击，才能利用侧信道、或从虚拟机“逃逸”到hypervisor，进行接下来的跨VM攻击。</p>
<p>也就是说，一方面，同驻攻击本身是利用侧信道技术确认已经与受害者同驻的；另一方面，在实现同驻后，攻击者可以利用侧信道进行跨VM攻击，从而窃取机密信息。</p>
<p>本文主要侧重介绍同驻的原理和实现方法。至于侧信道，会放在在同驻检测部分介绍。</p>
<p>同驻攻击也分为两步：放置和检测。前者指攻击者将恶意VM放置在云中与目标客户相同的物理机器上，这里一般会利用云中虚拟机放置策略的漏洞；后者指攻击者需要判断两个虚拟机是否已经成功同驻，比如利用侧信道技术，可以实现同驻检测。</p>
<h2 id="关于我看的文章"><a href="#关于我看的文章" class="headerlink" title="关于我看的文章"></a>关于我看的文章</h2><p>最先提出在云中同驻情况下利用侧信道的文章是2009年发表在会议ccs上的Hey, You, Get Off of My Cloud: Exploring Information Leakage in Third-Party Compute Clouds[1]。根据这篇文章的被引情况，可以发现在这之后，研究人员不仅找到了更多在同驻情况下可能造成威胁的侧信道，还提出了一些针对某类侧信道的防御方法。</p>
<p>然而云技术发展很快，自从亚马逊推出并引入了VPC（virtual private cloud）[4]，早期提出的攻击方法和防御方法就显得有些过时，不那么适用了。</p>
<p>于是，在2015年的usenix会议上，出现了两篇与同驻攻击相关的文章，都是在当前新的VPC环境的背景下开展研究工作的。</p>
<p>其中一篇题为A Placement Vulnerability Study in Multi-Tenant Public Clouds[2]，它基于[1]的工作重新讨论和评估了在目前云环境下的同驻问题。该作者还认为，之前好些研究工作的关注点放在侧信道本身的发现和防御，但随着越来越多新的侧信道被发现，既然不可能完全通晓系统究竟有多少侧信道，那么解决虚拟机同驻攻击才是更本质的研究点。</p>
<h2 id="新形势-VPC-下的同驻-调研背景"><a href="#新形势-VPC-下的同驻-调研背景" class="headerlink" title="新形势(VPC)下的同驻/调研背景"></a>新形势(VPC)下的同驻/调研背景</h2><p>在[1]最早提出利用侧信道攻击在虚拟机实现同驻后窃取同驻VM机密信息的方法后，很多人开始对云环境中虚拟机同驻情况下的侧信道攻击进行研究，也发现了更多可以被利用的侧信道以及缓解侧信道攻击的方法。</p>
<p>然而亚马逊云随后就引入了虚拟私有云VPC，即virtual private cloud。VPC将EC2的大型网络资源池中各个实例隔离,允许用户在自己定义的虚拟网络中启动云计算资源，向租户提供了隔离的网络环境。<br>事实证明，VPC确实是目前防御同驻威胁最有效果的方法了，没有同驻，自然也不存在侧信道被利用的问题。传统的同驻攻击常通过扫描内部IP地址确定攻击目标的，引入VPC后，传统方法就完全失效了,因为VPC是可以隐藏实例的内部IP地址的。也就是说，在VPC之前，攻击者可以通过扫描轻易得到实例的内部IP地址；而现在处于VPC中的实例的则只会暴露公有IP。</p>
<p>那么有了VPC彻底解决了同驻问题了吗？并不是。VPC仅仅在逻辑上隔离网络，所以来自不同VPC的实例仍然可以共享相同的物理机器,有实现同驻的机会。</p>
<p>但不管怎么说，VPC机制的确大幅提高了攻击成本。根据数据可得知，在2008年实现同驻是极其容易的，如果有两个帐户,各启动20个实例,就能观察到7到8对虚拟机同驻[1]；在2012年,160个实例启动能观察到一对同驻。这是因为云服务提供商为了抑制同驻威胁，一方面一直在改进其VM放置算法；另一方面也在网络管理方面做出了调整，例如引入VPC、改进路由配置等。所以，实现同驻已经变得越来越困难了。</p>
<p>那么，[1]中思想虽然经典，但在它的具体手法在当前云环境下是否有效呢？[2]就是在这样的情况下，验证虽然[1]中提出的部分方法已经失效了，但通过实验证实，在主流公有云EC2，GCE和Azure中，实现同驻的成本还是很低。另外，同期的文章[3]也描述了一种适应当前环境的新的同驻方案，然后评估了VPC的影响，并提出了一种量化评估同驻攻击的解决方案。</p>
<h2 id="放置策略"><a href="#放置策略" class="headerlink" title="放置策略"></a>放置策略</h2><h3 id="实现在同一台机器上放置的原理"><a href="#实现在同一台机器上放置的原理" class="headerlink" title="实现在同一台机器上放置的原理"></a>实现在同一台机器上放置的原理</h3><p>公有云（如Amazon EC2，Google Compute Engine和Microsoft Azure）中，通常，用户注册帐户购买服务后可以在管理控制台指定VM配置，其中配置参数包括实例类型，磁盘映像，托管VM的数据中心或区域等，配置完成后即可启动该VM实例。在这期间，云提供商的VM启动服务会从客户端接收描述VM的配置期望的一组参数，然后为新的VM分配资源。</p>
<p>那么在配置过程中就存在一个问题：选择哪一台物理主机运行该VM？这就是云中的虚拟机放置（placement）策略。</p>
<p>虽然云提供商不公布放置策略算法，但用户可以控制配置参数，从而影响VM放置。 图1中给出了一些值得注意的参数列表。</p>
<p>图1</p>
<p>通过控制这些变量，攻击者就可以一定程度上影响VM在物理机器上的放置，从而实现与受害者同驻了。比如说数据中心的选取，一些小的数据中心机器因为少，机器发生同驻的概率更大一些。</p>
<h3 id="相关的实验和评估"><a href="#相关的实验和评估" class="headerlink" title="相关的实验和评估"></a>相关的实验和评估</h3><p>为了详细探究VM放置策略的脆弱点，[2]设置了一个实验，通过评估三个公共云，Amazon EC2、Google Compute Engine和Microsoft Azure，对目前的放置策略的脆弱性进行了研究。简单的说，这个实验为图1展示的变量设置了一些值，并通过枚举这些配置，检查同驻情况。</p>
<p>另外，他们自行定义了一种放置策略作为参考。该实验最后得出的结论是，实验显示在Amazon EC2、Google Compute Engine和Microsoft Azure中，实现同驻的成功率是参考策略的成功率的10倍，而且便宜了至少114美元。所以说，同驻的危害比我们想象中的要大得多。</p>
<h2 id="同驻检测"><a href="#同驻检测" class="headerlink" title="同驻检测"></a>同驻检测</h2><p>要研究同驻攻击，乃至进行放置策略的脆弱性分析，同驻检测技术——识别两个虚拟机是否驻留在第三方公共云中的同一台物理机上是重要先决条件。</p>
<p>[1]虽然提出一些检测技术，但已不适用当前云环境。在网络层面，VPC增强了云租户之间的隔离，阻碍了已知的共存检测技术，首先，云租户拥有了私密的内部IP地址，cloud cartography方法不再可行，其次，VPC要求租户之间利用公共ip通信，使用的公共IP地址路由到数据中心，而不再是hypervisor中的short-circuitingnetwork timing test。在系统层面，由于现在云技术会运用多个CPU package(?)，所以，基于缓存，比如LLC的隐蔽通道[5]也不是那么可靠了，同一机器上的两个VM不一定还会共享LLC了。</p>
<p>也就是说，在[2]和[3]发表前，没有任何一种技术能可靠的用于在云中检测同驻。</p>
<p>总的来说，大部分同驻检测方法一直以来都是通过侧信道实现的，所以，首先对侧信道技术进行简单的介绍。</p>
<h3 id="侧信道技术介绍-分类"><a href="#侧信道技术介绍-分类" class="headerlink" title="侧信道技术介绍/分类"></a>侧信道技术介绍/分类</h3><p>云提供商不会告诉我们虚拟机是否同驻，所以通常要采用基于侧信道技术的检测方法。侧信道可以分为三类：逻辑侧信道、性能侧信道，以及隐蔽通道。</p>
<p><strong>逻辑侧信道（Logical side-channel）</strong><br>通过程序中可见的逻辑资源（例如IP地址，时间戳计数器值）的泄漏信息。比如在Amazon EC2中，每个VM都分配有两个IP地址，一个公共IP地址和一个内部IP地址。 EC2云计算架构允许将公共IP地址转换为内部IP，这样攻击者就可以通过映射得到内部拓扑，乃至整个公有云的架构。一般来说，同驻的虚拟机趋于具有相近的内部IP地址。</p>
<p><strong>性能侧信道（Performance side-channel）</strong><br>如果资源竞争会导致性能变化，这样的变化就可以用作同驻的指示符。比如，利用网络性能检测同驻[6]。</p>
<p><strong>隐蔽信道（Convert channel）</strong><br>作为侧信道的中一种特别的情况，隐蔽信道只能在两个VM都能被控制的情况下建立，称这样的VM为合作VM。隐蔽通道是基于共享硬件资源造成的，比如基于LLC（last level cache）的检测技术[5]。这类检测技术只能用于实验，实际攻击中无法应用。</p>
<h3 id="一种检测方法的具体实现"><a href="#一种检测方法的具体实现" class="headerlink" title="一种检测方法的具体实现"></a>一种检测方法的具体实现</h3><p>本节检测方法由[2]提出。<br>本节分为两部分，首先介绍了适用于合作VM的、基于隐蔽通道的检测方法；然后介绍了一种更普遍的、不需要两个VM合作的检测方法。</p>
<p><strong>仅适用于合作VM的方法</strong><br>既然是合作VM，那么选择利用共享硬件资源的隐蔽通道。隐蔽信道由发送者和接收者组成。总的来说，就是发送方竞争某一共享资源，接收机通过周期性地测量感知到竞争，从而建立通道。</p>
<p>[2]所提出的方法是基于x86处理器支持原子级内存操作，并且使用高速缓存来协调。方法大概流程是这样的：当发送方的一个锁定操作越过高速缓存行边界时，处理器会临时锁定内存总线。这时候，总线进行的其它操作（比如从DRAM取数据）就会变慢了，接收方就能感知到这样的变化。于是发送方和接收方之间建立了一个隐蔽通道。</p>
<p>原文中有具体实现和核心代码段。与基于缓存的隐蔽通道不同，无论虚拟机是否共享CPU核心或软件包，这一方法都可以工作。</p>
<p>其实我之前一直不太明白为什么明明已经可以控制这两台虚拟机了，还要检测同驻？作者给出的解释是：这种机制主要用来观察和研究公有云的放置策略。</p>
<p><strong>可适用于非合作VM的方法</strong><br>对于现实中的攻击者来说，受害者VM肯定不是合作的。所以作者将上面提出的方法改进了一下。</p>
<p>作者假定了一个现实攻击场景，攻击者只能使用受害者允许传入请求的接口，例如HTTP、FTP等。而且受害者的用户服务背后可能基于负载均衡器运行着多个实例。在这种情况下，攻击者如何检测与一个或多个受害VM的同驻？</p>
<p>过程如下：攻击者向受害者发送大量请求，这些请求必须可以使得受害VM触及内存总线，所以，如果攻击者与受害者同驻，那么攻击者上的接收器就可以感知到性能变化。这就与受害VM之间建立了一个上一节所说的性能侧信道。</p>
<p>另外，对于攻击者，可以使用现成的HTTP性能测量实用程序HTTPerf 作为接收器。整个过程非常方便。</p>
<h2 id="总结"><a href="#总结" class="headerlink" title="总结"></a>总结</h2><p>这是一篇概述和入门</p>
<h2 id="参考文献"><a href="#参考文献" class="headerlink" title="参考文献"></a>参考文献</h2><p>[1] T. Ristenpart, E. Tromer, H. Shacham, and S. Savage. Hey, you, get off of my cloud: Exploring information leakage in third-party com- pute clouds. In Proceedings of the 16th ACM conference on Com- puter and communications security, pages 199–212. ACM, 2009.<br>[2] Varadarajan, V., Zhang, Y., Ristenpart, T.and Swift, M. A placement vulnerability study in multi-tenant public clouds. In 24th USENIX Security Symposium (USENIX Security 15) (2015),pp. 913–928.<br>[3] Z. Xu, H. Wang, and Z. Wu. A measurement study on co-residence threat inside the cloud. In USENIX Security Symposium, 2015.<br>[4] Amazon Virtual Private Cloud (VPC) <a href="https://aws.amazon.com/cn/vpc/" target="_blank" rel="external">https://aws.amazon.com/cn/vpc/</a></p>

          
        
      
    </div>

    <div>
      
    </div>

    <div>
      
    </div>

    <footer class="post-footer">
      

      

      
      
        <div class="post-eof"></div>
      
    </footer>
  </article>


    
      

  
  

  
  
  

  <article class="post post-type-normal " itemscope itemtype="http://schema.org/Article">

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">
            
            
              
                
                <a class="post-title-link" href="/2016/12/08/7-浏览器安全（1）-原理 时序 render dom树构建/" itemprop="url">
                  浏览器安全 -原理 时序 Render DOM树构建
                </a>
              
            
          </h1>
        

        <div class="post-meta">
          <span class="post-time">
            <span class="post-meta-item-icon">
              <i class="fa fa-calendar-o"></i>
            </span>
            <span class="post-meta-item-text">发表于</span>
            <time itemprop="dateCreated" datetime="2016-12-08T02:43:56+08:00" content="2016-12-08">
              2016-12-08
            </time>
          </span>

          
            <span class="post-category" >
              &nbsp; | &nbsp;
              <span class="post-meta-item-icon">
                <i class="fa fa-folder-o"></i>
              </span>
              <span class="post-meta-item-text">分类于</span>
              
                <span itemprop="about" itemscope itemtype="https://schema.org/Thing">
                  <a href="/categories/web安全/" itemprop="url" rel="index">
                    <span itemprop="name">web安全</span>
                  </a>
                </span>

                
                

              
            </span>
          

          
            
          

          

          
          

          
        </div>
      </header>
    


    <div class="post-body" itemprop="articleBody">

      
      

      
        
          
            <p>上一篇机器学习的博客一直没给补完，然而我现在还是想再挖个坑，浏览器安全…<br>这周先补完，再开个论文总结和翻译系列吧。</p>
<p>言归正传，<strong>浏览器安全是归类到web安全中的。</strong></p>
<p>想想安全行业里最多的就是搞Web安全的人，需求略大、门槛略低，以及这算是离“黑客”二字最近的技术了。说起来有些群里那些初高中的少年还真让我很是羡慕，我们都老了，年轻人才是祖国的未来啊~</p>
<p>我以前对Web安全的了解也停留在通过注入啊、上传啊这些手段“拿站”，还有owasp10。实际上它是有一个架构和体系的，总的来说，Web安全可以从<strong>客户端安全</strong>和<strong>服务器端安全</strong>两方面讨论。</p>
<p><strong>浏览器安全属于Web安全中的客户端安全部分</strong>，当然，还有XSS、CSRF、点击劫持等都能算到客户端安全这一类中。而服务端安全包含了SQL注入、文件上传、配置安全、拒绝服务等问题。</p>
<p>分类来自《白帽子讲Web安全》，看看书的目录就能明白，这里就不上图了。</p>
<p>关于浏览器原理的文章：<a href="http://taligarsiel.com/Projects/howbrowserswork1.htm" target="_blank" rel="external">《How browsers work》</a>经典</p>
<h2 id="架构"><a href="#架构" class="headerlink" title="架构"></a>架构</h2><p>浏览器大概分为以下几个部分，实际上，不同浏览器如chrome、firefox等的具体实现会有一些区别。</p>
<p><img src="http://img.blog.csdn.net/20161208140704975?watermark/2/text/aHR0cDovL2Jsb2cuY3Nkbi5uZXQvSV9hbV9nb2luZw==/font/5a6L5L2T/fontsize/400/fill/I0JBQkFCMA==/dissolve/70/gravity/SouthEast" alt="这里写图片描述"></p>
<p>用户界面：与用户交互、接受用户操作。<br>浏览器引擎：提供接口（加载、刷新、后退等），操作渲染引擎。这样渲染引擎就与平台无关，可以移植了</p>
<p><strong>渲染引擎</strong>：解析HTML和CSS，完成布局和显示。<strong>浏览器的核心</strong>，这个是要详细介绍的。</p>
<p>网络：协议解析，网络I/O等<br>JavaScript解释器：解析JS代码。也有XML的解释器，不单独列出了。<br>用户界面后端：用于绘制基本小部件（如组合框、窗口）。它暴露不是平台特定的通用接口。其下使用操作系统用户界面方法。<br>数据存储模块：存cookie、缓存、书签等。</p>
<hr>
<p>Chrome从修改开源的Webkit，到自己的Blink渲染引擎；Firefox的Gecko；IE的trident。网上或多或少有些资料，可以看到这些内核在实现上、结构上都有一些区别。</p>
<p>去年微软新出了Edge，渲染引擎是EdgeHTML，JS引擎是Chakra，都是新的。其中<a href="https://github.com/Microsoft/ChakraCore" target="_blank" rel="external">Chakra</a>已经开源。</p>
<p>比如chrome，从总体结构到各个模块的详细分析，深入研究的资料已经挺多了。所以本文主要对edge进行探索。</p>
<hr>
<h3 id="Edge分析"><a href="#Edge分析" class="headerlink" title="Edge分析"></a>Edge分析</h3><p>查阅资料，官方没有直接给出Edge的架构图。但首先可以得到的信息是：①Edge采用的渲染引擎是edgehtml；②Edge采用的JS引擎是chakra，且微软已开源。</p>
<p>现在需要知道的是，还有哪些动态链接库呢？<br>查找前人资料，首先可以知道IE的模块如下图：</p>
<p><img src="http://img.blog.csdn.net/20161208163104871?watermark/2/text/aHR0cDovL2Jsb2cuY3Nkbi5uZXQvSV9hbV9nb2luZw==/font/5a6L5L2T/fontsize/400/fill/I0JBQkFCMA==/dissolve/70/gravity/SouthEast" alt="这里写图片描述"></p>
<p>为了得到更多信息，安装win10虚拟机，这个win10的<a href="https://developer.microsoft.com/en-us/microsoft-edge/tools/vms/" target="_blank" rel="external">镜像</a>是专用来试用Edge的，没有IE之类多余的东西。</p>
<p>找到Edge的安装目录，发现安装文件夹下还包含EdgeContent.dll，eview.dll，emodel.dll，edata.dll四个库文件。以及可执行文件有MicrosoftEdge.exe和MicrosoftEdgecp.exe两种。</p>
<p><img src="http://img.blog.csdn.net/20161221151428604?watermark/2/text/aHR0cDovL2Jsb2cuY3Nkbi5uZXQvSV9hbV9nb2luZw==/font/5a6L5L2T/fontsize/400/fill/I0JBQkFCMA==/dissolve/70/gravity/SouthEast" alt="这里写图片描述"></p>
<p>要探明dll被调用关系，于是首先使用Process Explorer查看进程调用dll的情况，如图，可以看到MicrosoftEdgecp.exe调用的dll显示在下方：</p>
<p><img src="http://img.blog.csdn.net/20161221151502188?watermark/2/text/aHR0cDovL2Jsb2cuY3Nkbi5uZXQvSV9hbV9nb2luZw==/font/5a6L5L2T/fontsize/400/fill/I0JBQkFCMA==/dissolve/70/gravity/SouthEast" alt="这里写图片描述"></p>
<p>最终与浏览器相关的进程包括SearchUI、MicrosoftEdge.exe和MicrosoftEdgecp.exe。其中在ie中就存在的urlmon.dll和wininet.dll都可以被这三个进程调用。另外，MicrosoftEdge.exe会调用的是eview.dll，emodel.dll，edata.dll系列；而MicrosoftEdgecp.exe调用的是EdgeContent.dll、edgehtml.dll系列，以及可以调用js引擎chakra.dll；SearchUI.exe与MicrosoftEdgecp.exe差不多，但是没有调用EdgeConetnt.dll。</p>
<p>这其中还有一个问题，就是dll之间的相互调用关系。这里使用dependency查看，如图打开EdgeContent.dll：</p>
<p><img src="http://img.blog.csdn.net/20161221151555965?watermark/2/text/aHR0cDovL2Jsb2cuY3Nkbi5uZXQvSV9hbV9nb2luZw==/font/5a6L5L2T/fontsize/400/fill/I0JBQkFCMA==/dissolve/70/gravity/SouthEast" alt="这里写图片描述"></p>
<p>查看所有dll后，基本上能得到这几个已知组件的层次。最后自绘一个乱猜的edge架构图供参考，不要当真：</p>
<p><img src="http://img.blog.csdn.net/20161221151654392?watermark/2/text/aHR0cDovL2Jsb2cuY3Nkbi5uZXQvSV9hbV9nb2luZw==/font/5a6L5L2T/fontsize/400/fill/I0JBQkFCMA==/dissolve/70/gravity/SouthEast" alt="这里写图片描述"></p>
<h2 id="浏览器事件处理时序"><a href="#浏览器事件处理时序" class="headerlink" title="浏览器事件处理时序"></a>浏览器事件处理时序</h2><p>比如，加载带有JavaScript脚本的HTML文档：</p>
<p><img src="http://img.blog.csdn.net/20161221150639547?watermark/2/text/aHR0cDovL2Jsb2cuY3Nkbi5uZXQvSV9hbV9nb2luZw==/font/5a6L5L2T/fontsize/400/fill/I0JBQkFCMA==/dissolve/70/gravity/SouthEast" alt="这里写图片描述"></p>
<h2 id="渲染引擎原理"><a href="#渲染引擎原理" class="headerlink" title="渲染引擎原理"></a>渲染引擎原理</h2><p>渲染的过程如图：（图出自软件安全与脆弱性分析ppt）</p>
<p><img src="http://img.blog.csdn.net/20161209005324049?watermark/2/text/aHR0cDovL2Jsb2cuY3Nkbi5uZXQvSV9hbV9nb2luZw==/font/5a6L5L2T/fontsize/400/fill/I0JBQkFCMA==/dissolve/70/gravity/SouthEast" alt="这里写图片描述"></p>
<p>即首先构建DOM树，再结合CSS样式规则构建Render树，最后根据Render树来布局并绘制。</p>
<p>具体如何生成的呢，比如说，给出如下代码：<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div></pre></td><td class="code"><pre><div class="line">&lt;body&gt;</div><div class="line">&lt;div id=&quot;sample&quot;&gt;</div><div class="line">  &lt;h3&gt;HTML DOM Tree&lt;/h3&gt;</div><div class="line">  &lt;div id=&quot;myDiagramDiv&quot; style=&quot;border: 1px solid blue; width:100%; height:300px&quot;&gt;&lt;/div&gt;</div><div class="line">    &lt;p&gt;</div><div class="line">        Sample</div><div class="line">    &lt;/p&gt;</div><div class="line">    &lt;p&gt;</div><div class="line">        &lt;a href=&quot;button.html&quot; target=&quot;_blank&quot;&gt;Button&lt;/a&gt;, </div><div class="line">        click to open &lt;a href=&quot;google.com&quot;&gt;google&lt;/a&gt;.</div><div class="line">    &lt;/p&gt;</div><div class="line">  &lt;p id=&quot;lastParagraph&quot;&gt;</div><div class="line">    Elements</div><div class="line">  &lt;/p&gt;</div><div class="line">  &lt;div id=&quot;otherInfo&quot;&gt;</div><div class="line">    &lt;div id=&quot;tableContainer&quot; style=&quot;display: inline-block;&quot;&gt;</div><div class="line">      &lt;table style=&quot;border: 1px; border-collapse: collapse;&quot;&gt;</div><div class="line">        &lt;tbody&gt;&lt;tr&gt;</div><div class="line">        &lt;th id=&quot;firstHeader&quot;&gt;Table header&lt;/th&gt;</div><div class="line">        &lt;th id=&quot;secondHeader&quot;&gt;Table header 2&lt;/th&gt;</div><div class="line">        &lt;/tr&gt;</div><div class="line">      &lt;/tbody&gt;&lt;/table&gt;</div><div class="line">    &lt;/div&gt;</div><div class="line">  &lt;/div&gt;</div><div class="line">&lt;/div&gt;</div><div class="line">&lt;/body&gt;</div></pre></td></tr></table></figure></p>
<h3 id="DOM树构建"><a href="#DOM树构建" class="headerlink" title="DOM树构建"></a>DOM树构建</h3><p><img src="http://img.blog.csdn.net/20161221150841904?watermark/2/text/aHR0cDovL2Jsb2cuY3Nkbi5uZXQvSV9hbV9nb2luZw==/font/5a6L5L2T/fontsize/400/fill/I0JBQkFCMA==/dissolve/70/gravity/SouthEast" alt="这里写图片描述"></p>
<h3 id="Render树构建"><a href="#Render树构建" class="headerlink" title="Render树构建"></a>Render树构建</h3><p><img src="http://img.blog.csdn.net/20161221150914201?watermark/2/text/aHR0cDovL2Jsb2cuY3Nkbi5uZXQvSV9hbV9nb2luZw==/font/5a6L5L2T/fontsize/400/fill/I0JBQkFCMA==/dissolve/70/gravity/SouthEast" alt="这里写图片描述"></p>

          
        
      
    </div>

    <div>
      
    </div>

    <div>
      
    </div>

    <footer class="post-footer">
      

      

      
      
        <div class="post-eof"></div>
      
    </footer>
  </article>


    
      

  
  

  
  
  

  <article class="post post-type-normal " itemscope itemtype="http://schema.org/Article">

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">
            
            
              
                
                <a class="post-title-link" href="/2016/11/30/6non-机器学习-决策树实现密码强度分析(python)/" itemprop="url">
                  machine learing/决策树实现密码强度评价(python)
                </a>
              
            
          </h1>
        

        <div class="post-meta">
          <span class="post-time">
            <span class="post-meta-item-icon">
              <i class="fa fa-calendar-o"></i>
            </span>
            <span class="post-meta-item-text">发表于</span>
            <time itemprop="dateCreated" datetime="2016-11-30T23:43:56+08:00" content="2016-11-30">
              2016-11-30
            </time>
          </span>

          
            <span class="post-category" >
              &nbsp; | &nbsp;
              <span class="post-meta-item-icon">
                <i class="fa fa-folder-o"></i>
              </span>
              <span class="post-meta-item-text">分类于</span>
              
                <span itemprop="about" itemscope itemtype="https://schema.org/Thing">
                  <a href="/categories/机器学习做安全/" itemprop="url" rel="index">
                    <span itemprop="name">机器学习做安全</span>
                  </a>
                </span>

                
                

              
            </span>
          

          
            
          

          

          
          

          
        </div>
      </header>
    


    <div class="post-body" itemprop="articleBody">

      
      

      
        
          
            <h2 id="决策树"><a href="#决策树" class="headerlink" title="决策树"></a>决策树</h2><h2 id="scikit-learn"><a href="#scikit-learn" class="headerlink" title="scikit -learn"></a>scikit -learn</h2><h2 id="实现流程"><a href="#实现流程" class="headerlink" title="实现流程"></a>实现流程</h2><h3 id="规则定义"><a href="#规则定义" class="headerlink" title="规则定义"></a>规则定义</h3><h3 id="训练集问题"><a href="#训练集问题" class="headerlink" title="训练集问题"></a>训练集问题</h3><h3 id="模型训练"><a href="#模型训练" class="headerlink" title="模型训练"></a>模型训练</h3>
          
        
      
    </div>

    <div>
      
    </div>

    <div>
      
    </div>

    <footer class="post-footer">
      

      

      
      
        <div class="post-eof"></div>
      
    </footer>
  </article>


    
      

  
  

  
  
  

  <article class="post post-type-normal " itemscope itemtype="http://schema.org/Article">

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">
            
            
              
                
                <a class="post-title-link" href="/2016/11/30/5-分析所采集的流量样本  还原一次攻击的过程/" itemprop="url">
                  利用wireshark分析攻击流量样本
                </a>
              
            
          </h1>
        

        <div class="post-meta">
          <span class="post-time">
            <span class="post-meta-item-icon">
              <i class="fa fa-calendar-o"></i>
            </span>
            <span class="post-meta-item-text">发表于</span>
            <time itemprop="dateCreated" datetime="2016-11-30T22:43:56+08:00" content="2016-11-30">
              2016-11-30
            </time>
          </span>

          
            <span class="post-category" >
              &nbsp; | &nbsp;
              <span class="post-meta-item-icon">
                <i class="fa fa-folder-o"></i>
              </span>
              <span class="post-meta-item-text">分类于</span>
              
                <span itemprop="about" itemscope itemtype="https://schema.org/Thing">
                  <a href="/categories/攻击样本-漏洞分析/" itemprop="url" rel="index">
                    <span itemprop="name">攻击样本/漏洞分析</span>
                  </a>
                </span>

                
                

              
            </span>
          

          
            
          

          

          
          

          
        </div>
      </header>
    


    <div class="post-body" itemprop="articleBody">

      
      

      
        
          
            <p>此次分析样本是.pcap格式，共348帧。主要利用的分析工具是wireshark以及它的命令行版本tshark。</p>
<h2 id="前期分析"><a href="#前期分析" class="headerlink" title="前期分析"></a>前期分析</h2><p>首先通过观察，发现只涉及到两个ip，在本文中称98.114.205.102为主机A，192.150.11.111为主机B。<br>如下图，A主动向B请求TCP连接，并完成了三次握手。<br><img src="http://img.blog.csdn.net/20161130230717869" alt="三次握手"><br>虽然不能断定，但很有可能A为攻击者，B为受害者，A攻击的是B的主机系统。</p>
<p>理论上说这种类型的攻击一定利用了已知系统漏洞或者0day，所以接下来的目标是找到A究竟利用了什么漏洞对B实施了攻击。</p>
<p>于是观察有没有能够暴露更多信息的数据帧。如下图，可以看到在第33帧有一个函数被调用。这非常可疑。网上搜一下这个API，很快发现它曾经曝出过问题，编号CVE-2003-0533，winodws上大名鼎鼎的“冲击波”利用的就是这个漏洞，微软给的编号是MS04-011。<br><img src="http://img.blog.csdn.net/20161130231830132" alt="函数调用"></p>
<p>该漏洞是一个远程缓冲区溢出，DCE/RPC请求可以从远程主机发送到本地机的LSASS.EXE进程（Microsoft Windows LSA是本地安全授权服务(LSASRV.DLL)）。LSASS DCE/RPC末端导出的Microsoft活动目录服务存在一个缓冲区溢出，远程攻击者可以利用这个漏洞以SYSTEM权限在系统上执行任意指令。攻击LSASS的漏洞的基本办法，就是构造长参数DomainName，通过DsRoleUpgradeDownlevelServer()这个API，最终造成溢出和返回shell。</p>
<h2 id="流程分析"><a href="#流程分析" class="headerlink" title="流程分析"></a>流程分析</h2><p>已知B被利用的是哪个漏洞，再分析整个流程就简单了。</p>
<p>整个攻击过程中包含5个TCP会话，按会话顺序描述流量样本的攻击流程。<br>（1）首先，A扫描B 445/tcp端口，确认该端口是否开放。（tcp.stream eq 0）<br><img src="http://img.blog.csdn.net/20161130233612156" alt="这里写图片描述"></p>
<p>（2）建立SMB会话，连接到B的\192.150.11.111\ipc$，并请求/lsarpc。（tcp.stream eq 1）<br><img src="http://img.blog.csdn.net/20161130233655844" alt="这里写图片描述"></p>
<p> 如图，在帧33的位置，通过构造恶意参数，调用存在漏洞的函数DsRoleUpgradeDownlevelServer()，<br>造成缓冲区溢出，并将shell绑定到1957端口。<br><img src="http://img.blog.csdn.net/20161130233731844" alt="这里写图片描述"></p>
<p>A连接到B  1957端口上的shell，即可在B上执行指令。（tcp.stream eq 2）<br><img src="http://img.blog.csdn.net/20161130233800000" alt="这里写图片描述"></p>
<p>查看追踪流，可知为了在B上植入恶意软件（蠕虫），A向B发送了如下命令，强制B连接ftp并下载ssms.exe。<br><img src="http://img.blog.csdn.net/20161130233826440" alt="这里写图片描述"></p>
<p>B执行（3）中命令，尝试建立FTP连接，请求下载ssms.exe。（tcp.stream eq 3）<br><img src="http://img.blog.csdn.net/20161130233856298" alt="这里写图片描述"><br>如下图：<br><img src="http://img.blog.csdn.net/20161130233944688" alt="这里写图片描述"></p>
<p>B通过ftp接收文件ssms.exe(恶意样本)。<br><img src="http://img.blog.csdn.net/20161130234030646" alt="这里写图片描述"></p>
<p>追踪流，可见开头MZ、PE字符，显然，正在传输的是windows可执行程序。（tcp.stream eq 4）<br><img src="http://img.blog.csdn.net/20161130234109099" alt="这里写图片描述"></p>
<p>接下来A再次连接到shell，强制B执行恶意文件ssms.exe即可。</p>
<h2 id="疑点分析和结论"><a href="#疑点分析和结论" class="headerlink" title="疑点分析和结论"></a>疑点分析和结论</h2><p>（1）整个攻击实施时间非常短，全过程仅花费16秒；另外，在这五次TCP会话中，出现了会话间间隔小于1秒的情况。人工输入命令的速度不可能这么快，所以说这次攻击肯定是自动化的。<br>另外，恶意文件ssms.exe被mcfee引擎识别为W32/Sdbot.worm.gen.x，是个蠕虫。</p>
<p>（2）攻击者A在发送如下指令时出现了错误：</p>
<blockquote>
<p>echo open 0.0.0.0 8884 &gt; o</p>
</blockquote>
<p>使用了无效的ip，0.0.0.0，该处ip值本应为98.114.205.102。这一错误一方面再次证明此次攻击不是人工实施，人工不会出现这样的错误；另一方面，为何在出错的情况下B仍然执行命令下载了恶意文件ssms.exe？这说明受害者B也是有问题的。</p>
<p>（3）windows xp系统的ttl值应当为128，而这个受害主机B的ttl值为64。进一步证明B实际上是一个蜜罐，伪装成了存在漏洞的windows系统，吸引网络上被感染的发起自动扫描的僵尸机上钩。</p>
<p>综上所述，攻击者A很可能是被蠕虫感染的主机，遭到感染后，利用端口扫描找到受害者B（蜜罐），并向其发起针对MS04-011漏洞的后续攻击行为。整个攻击过程都是自动发起和实施的。</p>
<p>来源和参考：<code>http://www.honeynet.org/node/504</code></p>

          
        
      
    </div>

    <div>
      
    </div>

    <div>
      
    </div>

    <footer class="post-footer">
      

      

      
      
        <div class="post-eof"></div>
      
    </footer>
  </article>


    
      

  
  

  
  
  

  <article class="post post-type-normal " itemscope itemtype="http://schema.org/Article">

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">
            
            
              
                
                <a class="post-title-link" href="/2016/11/29/4-为什么说反对可信计算“发展”/" itemprop="url">
                  关于可信计算“发展”
                </a>
              
            
          </h1>
        

        <div class="post-meta">
          <span class="post-time">
            <span class="post-meta-item-icon">
              <i class="fa fa-calendar-o"></i>
            </span>
            <span class="post-meta-item-text">发表于</span>
            <time itemprop="dateCreated" datetime="2016-11-29T22:43:56+08:00" content="2016-11-29">
              2016-11-29
            </time>
          </span>

          
            <span class="post-category" >
              &nbsp; | &nbsp;
              <span class="post-meta-item-icon">
                <i class="fa fa-folder-o"></i>
              </span>
              <span class="post-meta-item-text">分类于</span>
              
                <span itemprop="about" itemscope itemtype="https://schema.org/Thing">
                  <a href="/categories/杂谈/" itemprop="url" rel="index">
                    <span itemprop="name">杂谈</span>
                  </a>
                </span>

                
                

              
            </span>
          

          
            
          

          

          
          

          
        </div>
      </header>
    


    <div class="post-body" itemprop="articleBody">

      
      

      
        
          
            <p>可信计算在中国发展是否有用？<br>其实很想问..为何这种问题还要观点明确的表明赞成反对..</p>
<hr>
<p>作为一个没有深入研究过可信计算的信息安全专业学生，我不认为可信计算无用，但是对于可信计算目前在中国的“发展”，我是反对的。</p>
<p>目前可信计算正在被广泛的传播和科普，包括我自己在大学的时候。一个普通学生能听到两次院士的演讲还是相当激动的。但不知道其他人有没有同样的感受，可信计算附带的、某些非技术层面的理念实在让人不敢苟同。<strong>我甚至认为这些理念会让不了解信息安全的人们形成错误的观念，导致非常负面的后果。</strong></p>
<p>从可信计算最有力的推动者沈昌祥院士的报告里可以了解到，他认为可信计算达到的效果是“攻击者进不去，非授权者重要信息拿不到，窃取保密信息看不懂，系统和信息篡改不了，系统工作瘫不成，攻击行为赖不掉。我想听到这里，大部分人是不是会理解为，有可信计算，可高枕无忧。</p>
<p>我第一次听沈院士讲座是在省里组织的一场全国比赛的颁奖典礼上，在场的除了我们少数参赛者，其他大部分人是各个不同政府部门派过来听讲座的，连烟草、交通之类的部门都有。<strong>那时候我是从没听说过可信计算的小白</strong>，听完我的感觉就是，虽然不太懂但是好厉害的样子。我不知道那些领导有没有认真听，如果听了，他们得出的结论或许会是信息安全问题没那么严重，这些东西听不懂，跟我们普通人无关，等他们研究出来了我们就安全了。当然网上也有人说，沈院士的观点不能代表其他可信计算研究者。他们所说的也许更谨慎科学，但是院士的影响力就是那么大。</p>
<p>“有了可信计算，网络空间就彻底安全，所以安全是阳春白雪与我们无关的研究”。这真是非常危险的观念。<strong>现实中几千年都没有解决的偷盗问题，放到网络空间中，我们凭什么认为它就会消弭？</strong></p>
<p>且说社会工程学攻击手段。现在APT的概念很火。即使可信计算架构完美实现了，员工非要打开某个邮件附件，非要把密码设置得很简单，或者他是间谍，能是可信计算防的住的吗？</p>
<p>从攻击者的角度，<strong>很多时候攻击根本到不了那么深，在应用实现层面程序员犯过的错已经足够黑客研究了。</strong>如知乎云舒所说，比如说web，直接与用户交互，也是目前最受欢迎的攻击目标。端口扫描不能禁止，它是必要的服务；SQL注入，代码是数据库进程执行的；XSS、CSRF都是在浏览器的进程执行；点击劫持就更不用说了。再说其他应用程序，它总是为要做一些事情而存在的，而且程序员在开发过程中难免出错，只要有功能有输入输出，攻击者就有机可乘。安卓已经实现了所谓的trustzone，但是很多攻击手段并不是它所能覆盖的防护面。普通人认为最糟心的吸费蠕虫，反而在专业人员看来是技术含量最低的，随便一个android开发者都能做。</p>
<p>从可信计算的角度，可信计算基于信任。从初始的信任根到最后的可信应用，每个环节都通过信任链的前一环节验证来确保真实可信，数据是通过信任根-BIOS-引导程序-系统内核-应用层程序这条信任链保证其安全性。如果我的理解没错的话，逆向工作、正版软件的破解工作大概不再有用武之地。</p>
<p>是的，<strong>可信计算是很有必要，但是对于普通人普通企业又不是那么重要。所以，它不需要如此大范围的“发展”。</strong>机要部门首先需要高等级的防护，那么有研究人员首先给他们做就行了，现在的所谓“发展”是没有必要的。</p>
<p>我想之所以出现cyber space一词，就是因为发现网络空间不是那么单一简单的事物，它和我们的生活没有两样。有了保险柜，不代表东西都会放进去，有了防盗门，不代表可以不关窗。</p>
<p>毕竟安全是<strong>权衡</strong>利弊下的选择，且始终会以<strong>攻防</strong>的形式存在。</p>
<p>乔布斯说未来每个人都应学习写代码。而作为安全相关的研究从业者，我们向非专业人员传播的观念应当是进入信息时代，每个人都应提高安全意识，了解计算机相关知识，维护网络空间的安全秩序，<strong>如果想要高级安全服务？那就花钱买。而不是告诉大家，安全我来做，你不用管。</strong></p>

          
        
      
    </div>

    <div>
      
    </div>

    <div>
      
    </div>

    <footer class="post-footer">
      

      

      
      
        <div class="post-eof"></div>
      
    </footer>
  </article>


    
      

  
  

  
  
  

  <article class="post post-type-normal " itemscope itemtype="http://schema.org/Article">

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">
            
            
              
                
                <a class="post-title-link" href="/2016/11/25/3-这半年，在半年/" itemprop="url">
                  这半年，再半年
                </a>
              
            
          </h1>
        

        <div class="post-meta">
          <span class="post-time">
            <span class="post-meta-item-icon">
              <i class="fa fa-calendar-o"></i>
            </span>
            <span class="post-meta-item-text">发表于</span>
            <time itemprop="dateCreated" datetime="2016-11-25T22:43:56+08:00" content="2016-11-25">
              2016-11-25
            </time>
          </span>

          
            <span class="post-category" >
              &nbsp; | &nbsp;
              <span class="post-meta-item-icon">
                <i class="fa fa-folder-o"></i>
              </span>
              <span class="post-meta-item-text">分类于</span>
              
                <span itemprop="about" itemscope itemtype="https://schema.org/Thing">
                  <a href="/categories/关于我/" itemprop="url" rel="index">
                    <span itemprop="name">关于我</span>
                  </a>
                </span>

                
                

              
            </span>
          

          
            
          

          

          
          

          
        </div>
      </header>
    


    <div class="post-body" itemprop="articleBody">

      
      

      
        
          
            <p>研一转眼过去大半了，时间一如既往的快。</p>
<p>以前以为，是因为有圈圈一起愉快的虚度时间，因为总想着学这学那，因为有人约三黑四黑，才显得大学跑得飞快，像是稍纵即逝。现在发现原来自己一个人吃吃睡睡上上课也过得挺快的。每周找找圈圈，偶尔和室友涮火锅，偶尔跟别人组队做个大作业，不像本科憋着劲要写代码，要参加比赛，要搞项目，要出去找个好实习，要奖学金要保研。</p>
<p>回过头想想，那时候想得很多，到最后也没几件事情是真正做好了。所以就这样吧，现在按部就班的感觉也挺好。可能我比以前更懒散了，也可能幸福感不仅会补上心里的洞，还会消磨掉斗志。</p>
<p>上一段坚持写博客的日子还是在大二那次短暂的ACM生涯，是集训队的要求，写的时候不情不愿的，也没啥可读性。但现在看看，至少它证明我曾走过那么一段路吧。而只字未留的后两年时光，是真的遗落在过去了，做过的事踩过的坑都越来越淡，回忆起来就是啊我以前当了好久Android程序员而且几乎就要继续当下去了。人生的选择真是奇妙。</p>
<p>不管怎么说，课结了好几门，又不用回研究所做事，希望自己自律一些，别吃了睡睡了吃，从今天开始坚持每两三天写一篇博客。无论是做了新东西，学到新东西，还是读了国际上相关论文，都记录下来，别忘了。</p>
<p>接下来的半个月，趁着时间没间隔太久，先把之前做的东西写了：</p>
<blockquote>
<ul>
<li>机器学习：利用决策树分析密码强度的python实现</li>
<li>漏洞利用/攻击追溯：一次恶意攻击的流量样本分析总结</li>
<li>Web安全/渗透：过一遍那本白帽子，记录有触动的；kali里自己常用的东西写一下总结。</li>
<li>Python：Flask做网站</li>
<li>CTF：之前刷的有价值的，自己没思路的，或者方便记上的都记上</li>
</ul>
</blockquote>
<p>还没有做但是必须做的事：</p>
<blockquote>
<ul>
<li>系统安全：可信计算赞同or反对  小论文截止12.1</li>
<li>云安全：虚拟化 虚拟机逃逸 同驻攻击 侧信道攻击 云监控</li>
<li>漏洞挖掘：看0day安全软件漏洞分析技术  看别人的poc exp  希望下学期开学前能入门</li>
<li>CTF：继续web，入门逆向</li>
<li>Python：目前想到要尝试写的包括，端口扫描 目录扫描 弱口令 反向shell web服务器 仿openstack云管理平台 常用设计模式实现</li>
<li>渗透：metasploit渗透测试魔鬼训练营  有时间动手过一遍</li>
<li>论文：一周至少翻译一篇顶会，想毕业一定要提高英语水平</li>
</ul>
</blockquote>
<p>希望能做到。希望不要再回首时一片空白。</p>
<p>还有圈圈明天就三年了啊你可能不知道在说远不远说近不近的以前我从未如此强烈的感受到原来我的生活也那么值得被珍惜生而为人真是太好了</p>
<p> three years</p>

          
        
      
    </div>

    <div>
      
    </div>

    <div>
      
    </div>

    <footer class="post-footer">
      

      

      
      
        <div class="post-eof"></div>
      
    </footer>
  </article>


    
      

  
  

  
  
  

  <article class="post post-type-normal " itemscope itemtype="http://schema.org/Article">

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">
            
            
              
                
                <a class="post-title-link" href="/2016/11/12/1-CTF考核writeup（1）/" itemprop="url">
                  CTF writeup（1）-sql注入、文件上传和文件包含问题新思路
                </a>
              
            
          </h1>
        

        <div class="post-meta">
          <span class="post-time">
            <span class="post-meta-item-icon">
              <i class="fa fa-calendar-o"></i>
            </span>
            <span class="post-meta-item-text">发表于</span>
            <time itemprop="dateCreated" datetime="2016-11-12T22:43:56+08:00" content="2016-11-12">
              2016-11-12
            </time>
          </span>

          
            <span class="post-category" >
              &nbsp; | &nbsp;
              <span class="post-meta-item-icon">
                <i class="fa fa-folder-o"></i>
              </span>
              <span class="post-meta-item-text">分类于</span>
              
                <span itemprop="about" itemscope itemtype="https://schema.org/Thing">
                  <a href="/categories/web安全/" itemprop="url" rel="index">
                    <span itemprop="name">web安全</span>
                  </a>
                </span>

                
                

              
            </span>
          

          
            
          

          

          
          

          
        </div>
      </header>
    


    <div class="post-body" itemprop="articleBody">

      
      

      
        
          
            <p>在sql注入、文件上传和文件包含问题上，可以学到一些新思路。</p>
<h2 id="sql注入"><a href="#sql注入" class="headerlink" title="sql注入"></a>sql注入</h2><p>观察题目链接，很明显，存在注入的是id。于是利用sqlmap验证，但sqlmap的结果却是“not injectble”：</p>
<p>注意到链接中id值是‘MQ==’。明显参数是经过base64编码的，解码后值为‘1’。</p>
<p>sqlmap中内置了base64编码脚本：</p>
<blockquote>
<p>sqlmap -u “<a href="http://xxx/index.php?id=1" target="_blank" rel="external">http://xxx/index.php?id=1</a>“ - -tamper base64encode.py - -current-db</p>
</blockquote>
<p>发现确实是存在注入的。</p>
<p>接下来用sqlmap，按套路猜解，即可在flag表中找到flag。</p>
<blockquote>
<p>选择一个数据库猜表<br>sqlmap.py -u “–” -D demo –tables<br>选择一个表猜列<br>sqlmap.py -u “–” -D demo -T flag –columns<br>根据列猜数据<br>sqlmap.py -u “–” -D demo -T flag -C value –dump</p>
</blockquote>
<p>关键在于参数被base64编码。tamper目录中各种脚本还是很多的。</p>
<h2 id="文件上传"><a href="#文件上传" class="headerlink" title="文件上传"></a>文件上传</h2><p>查看题目，没有找到上传点。</p>
<p>扫了一下目录，发现/upload，看这目录名，一会儿上传的话应该是要传到这个目录下的。</p>
<p>首先想到是不是可以用PUT+COPY，尝试后发现被禁了。</p>
<blockquote>
<p>OPTIONS / HTTP/1.1<br>User-Agent: xxxx<br>Host: xxxx<br>Accept: <em>/</em></p>
</blockquote>
<p>比如PUT</p>
<blockquote>
<p>PUT /test.txt HTTP/1.1<br>User-Agent: xxxx<br>Host: xxxx<br>Accept: <em>/</em></p>
</blockquote>
<p>既然没有上传点，于是自行构造一个form表单。将action指向upload.php。这里还得要猜对name的值为file。再尝试从本地表单上传jpg文件，提交成功，表明此处确实有上传功能。这时会发现一个问题，不知道文件被传到哪儿了。所以在表单中添加一个隐藏域，将“dir”指定为“/upload/”。<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div></pre></td><td class="code"><pre><div class="line">&lt;form action=&quot;http://--/upload.php&quot; method=&quot;post&quot; enctype= &quot;multipart/form-data&quot;&gt;</div><div class="line">  &lt;input type=&quot;file&quot; name=&quot;file&quot; /&gt;&lt;/p&gt;</div><div class="line">  &lt;input type=&quot;hidden&quot; name=&quot;dir&quot; value=&quot;/upload/&quot;&gt;</div><div class="line">  &lt;input type=&quot;submit&quot;/&gt;</div><div class="line">&lt;/form&gt;</div></pre></td></tr></table></figure></p>
<p>再次上传jpg文件，成功上传到/upload目录下。接下来开始考虑上传phpshell。</p>
<p>尝试00截断，失败。后来发现内容为空的时候直接上传php文件竟然成功了。</p>
<p>访问，即可回显flag。</p>
<h2 id="文件包含"><a href="#文件包含" class="headerlink" title="文件包含"></a>文件包含</h2><p>首先尝试能否读上级目录，发现./被过滤为malicious parameter，而/../没有被过滤，所以检测的只是开头有没有.。</p>
<p>这种情况下，利用php伪协议filter，成功包含文件，读取flag。</p>
<blockquote>
<p>php://filter/resource=../flag</p>
</blockquote>

          
        
      
    </div>

    <div>
      
    </div>

    <div>
      
    </div>

    <footer class="post-footer">
      

      

      
      
        <div class="post-eof"></div>
      
    </footer>
  </article>


    
      

  
  

  
  
  

  <article class="post post-type-normal " itemscope itemtype="http://schema.org/Article">

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">
            
            
              
                
                <a class="post-title-link" href="/2016/11/12/2-CTF考核writeup（2）/" itemprop="url">
                  CTF writeup（2）-绕过、上传、xss、csrf方面的内容
                </a>
              
            
          </h1>
        

        <div class="post-meta">
          <span class="post-time">
            <span class="post-meta-item-icon">
              <i class="fa fa-calendar-o"></i>
            </span>
            <span class="post-meta-item-text">发表于</span>
            <time itemprop="dateCreated" datetime="2016-11-12T22:43:56+08:00" content="2016-11-12">
              2016-11-12
            </time>
          </span>

          
            <span class="post-category" >
              &nbsp; | &nbsp;
              <span class="post-meta-item-icon">
                <i class="fa fa-folder-o"></i>
              </span>
              <span class="post-meta-item-text">分类于</span>
              
                <span itemprop="about" itemscope itemtype="https://schema.org/Thing">
                  <a href="/categories/web安全/" itemprop="url" rel="index">
                    <span itemprop="name">web安全</span>
                  </a>
                </span>

                
                

              
            </span>
          

          
            
          

          

          
          

          
        </div>
      </header>
    


    <div class="post-body" itemprop="articleBody">

      
      

      
        
          
            <p>没有什么，保存下来。主要包括绕过、上传、xss、csrf方面的内容。</p>
<h2 id="0x01-Russian"><a href="#0x01-Russian" class="headerlink" title="0x01 Russian"></a>0x01 Russian</h2><p>利用burpsuite抓包，其他内容都很正常，发现cookie中info项比较可疑，大写小写数字都有，猜测其为base64编码过的字符串。通过Base64在线工具解码字符串，即得到了第一题flag。</p>
<h2 id="0x02-United-States"><a href="#0x02-United-States" class="headerlink" title="0x02 United States"></a>0x02 United States</h2><p>首先，在输入框尝试输入各种内容，系统提示“unless you are root”。于是输入root，弹窗提示“输入无效”。查看源码，发现前端对输入做了限制，而且仅限制了root。</p>
<p>burp绕过前端验证，将参数username的值修改为root。</p>
<p>成功跳转到了新的页面。新页面上提示“localhost（127.0.0.1）only”。</p>
<p>首先考虑到题意可能是限制ip来源，尝试后发现并不是。所以又尝试了修改Refer、Host。最终发现在<code>Host</code>被修改时拿到flag。</p>
<h2 id="0x03-Canada"><a href="#0x03-Canada" class="headerlink" title="0x03 Canada"></a>0x03 Canada</h2><p>打开题目，提示“The form below is protect by Django CSRF MIDDLEWARE”。先尝试点击getflag按钮，提示“Your CSRF token is not what I want. ”。</p>
<p>没有其他线索，先抓包。可以看到提交的参数是csrfmiddlewaretoken，另外cookie里也有一项csrftoken。没有及时截图，实际上第一次抓包的时候这两个值都是一串很长的编码字符串，它们值相等。如果修改其中一个，会报错“CSRF verification failed.”。</p>
<p>为了方便测试，看这两个值被修改的各种效果，我把这个请求放到了repeater模块。找到响应里居然有注释。前面两句代码大概意思是说，如果csrfmiddlewaretoken的值为bypass，那么则返回flag。另外还提到了一个Django的CVE。</p>
<p>看到提示，首先当然会把csrfmiddlewaretoken的值改成bypass，但仅仅这样肯定是无法通过保护机制验证的。实际上到了这里，基本上都能想到把cookie也改了。不过还是先看看<code>cve-2016-7401</code>。</p>
<p>这一漏洞造成的原因是，在某些版本的django中，cookie的解析代码是有问题的。如果这个网站同时采用了google analytics，此时攻击者就可以通过强制设置cookie来绕过csrf保护机制。</p>
<p>这道题的场景里，既然已知‘bypass’，已知漏洞，那就可以通过这种简单方法绕过，从而得到flag。</p>
<h2 id="0x04-China"><a href="#0x04-China" class="headerlink" title="0x04 China"></a>0x04 China</h2><p>随意上传一张图片。从提示看出，上传点对上传的文件类型应该是有一定要求的，而且很有可能要求的是txt、doc之类的。</p>
<p>第一次上传doc文档时未成功，又尝试了其他一些不同类型的文件，仍未上传成功。此时，将exe文件的Content-Type修改为doc文件的application/msword类型时，上传成功了。于是发现，只要Content-Type的值为application/msword，不论什么文件都可以上传成功，对实际类型和后缀都是没有过滤的。而第一次上传doc之所以失败是因为文件太大。</p>
<p>题目已提示考察XSS，首先想到上传文件名是否存在XSS。尝试<code>&lt;script&gt;</code>标签，根据结果可以看出‘/’及其之前的字符都被过滤了。</p>
<p>故想到利用img标签。在filename属性中构造语句：</p>
<blockquote>
<p>“<code>&gt;&lt;image src=1 onerror=alert(&#39;xss&#39;)&gt;</code>“</p>
</blockquote>
<p>由于‘&gt;’将之前的标签闭合，而src不存在，onerror弹窗，成功发起xss攻击。</p>

          
        
      
    </div>

    <div>
      
    </div>

    <div>
      
    </div>

    <footer class="post-footer">
      

      

      
      
        <div class="post-eof"></div>
      
    </footer>
  </article>


    
      

  
  

  
  
  

  <article class="post post-type-normal " itemscope itemtype="http://schema.org/Article">

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">
            
            
              
                
                <a class="post-title-link" href="/2016/08/07/hello-world/" itemprop="url">
                  Hello World
                </a>
              
            
          </h1>
        

        <div class="post-meta">
          <span class="post-time">
            <span class="post-meta-item-icon">
              <i class="fa fa-calendar-o"></i>
            </span>
            <span class="post-meta-item-text">发表于</span>
            <time itemprop="dateCreated" datetime="2016-08-07T22:53:08+08:00" content="2016-08-07">
              2016-08-07
            </time>
          </span>

          

          
            
          

          

          
          

          
        </div>
      </header>
    


    <div class="post-body" itemprop="articleBody">

      
      

      
        
          
            <p>Welcome to <a href="https://hexo.io/" target="_blank" rel="external">Hexo</a>! This is your very first post. Check <a href="https://hexo.io/docs/" target="_blank" rel="external">documentation</a> for more info. If you get any problems when using Hexo, you can find the answer in <a href="https://hexo.io/docs/troubleshooting.html" target="_blank" rel="external">troubleshooting</a> or you can ask me on <a href="https://github.com/hexojs/hexo/issues" target="_blank" rel="external">GitHub</a>.</p>
<h2 id="Quick-Start"><a href="#Quick-Start" class="headerlink" title="Quick Start"></a>Quick Start</h2><h3 id="Create-a-new-post"><a href="#Create-a-new-post" class="headerlink" title="Create a new post"></a>Create a new post</h3><figure class="highlight bash"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">$ hexo new <span class="string">"My New Post"</span></div></pre></td></tr></table></figure>
<p>More info: <a href="https://hexo.io/docs/writing.html" target="_blank" rel="external">Writing</a></p>
<h3 id="Run-server"><a href="#Run-server" class="headerlink" title="Run server"></a>Run server</h3><figure class="highlight bash"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">$ hexo server</div></pre></td></tr></table></figure>
<p>More info: <a href="https://hexo.io/docs/server.html" target="_blank" rel="external">Server</a></p>
<h3 id="Generate-static-files"><a href="#Generate-static-files" class="headerlink" title="Generate static files"></a>Generate static files</h3><figure class="highlight bash"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">$ hexo generate</div></pre></td></tr></table></figure>
<p>More info: <a href="https://hexo.io/docs/generating.html" target="_blank" rel="external">Generating</a></p>
<h3 id="Deploy-to-remote-sites"><a href="#Deploy-to-remote-sites" class="headerlink" title="Deploy to remote sites"></a>Deploy to remote sites</h3><figure class="highlight bash"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">$ hexo deploy</div></pre></td></tr></table></figure>
<p>More info: <a href="https://hexo.io/docs/deployment.html" target="_blank" rel="external">Deployment</a></p>

          
        
      
    </div>

    <div>
      
    </div>

    <div>
      
    </div>

    <footer class="post-footer">
      

      

      
      
        <div class="post-eof"></div>
      
    </footer>
  </article>


    
  </section>

  


          </div>
          


          

        </div>
        
          
  
  <div class="sidebar-toggle">
    <div class="sidebar-toggle-line-wrap">
      <span class="sidebar-toggle-line sidebar-toggle-line-first"></span>
      <span class="sidebar-toggle-line sidebar-toggle-line-middle"></span>
      <span class="sidebar-toggle-line sidebar-toggle-line-last"></span>
    </div>
  </div>

  <aside id="sidebar" class="sidebar">
    <div class="sidebar-inner">

      

      

      <section class="site-overview sidebar-panel  sidebar-panel-active ">
        <div class="site-author motion-element" itemprop="author" itemscope itemtype="http://schema.org/Person">
          <img class="site-author-image" itemprop="image"
               src="/uploads/x.png"
               alt="cuteme" />
          <p class="site-author-name" itemprop="name">cuteme</p>
          <p class="site-description motion-element" itemprop="description"></p>
        </div>
        <nav class="site-state motion-element">
          <div class="site-state-item site-state-posts">
            <a href="/archives">
              <span class="site-state-item-count">10</span>
              <span class="site-state-item-name">日志</span>
            </a>
          </div>

          
            <div class="site-state-item site-state-categories">
              <a href="/categories">
                <span class="site-state-item-count">7</span>
                <span class="site-state-item-name">分类</span>
              </a>
            </div>
          

          
            <div class="site-state-item site-state-tags">
              
                <span class="site-state-item-count">14</span>
                <span class="site-state-item-name">标签</span>
              
            </div>
          

        </nav>

        

        <div class="links-of-author motion-element">
          
        </div>

        
        

        
        

      </section>

      

    </div>
  </aside>


        
      </div>
    </main>

    <footer id="footer" class="footer">
      <div class="footer-inner">
        <div class="copyright" >
  
  &copy; 
  <span itemprop="copyrightYear">2016</span>
  <span class="with-love">
    <i class="fa fa-heart"></i>
  </span>
  <span class="author" itemprop="copyrightHolder">cuteme</span>
</div>

<div class="powered-by">
  a404
</div>

<div class="theme-info">
  主题 -
  <a class="theme-link" href="https://github.com/iissnan/hexo-theme-next">
    NexT.Pisces
  </a>
</div>

        

        
      </div>
    </footer>

    <div class="back-to-top">
      <i class="fa fa-arrow-up"></i>
    </div>
  </div>

  

<script type="text/javascript">
  if (Object.prototype.toString.call(window.Promise) !== '[object Function]') {
    window.Promise = null;
  }
</script>









  



  
  <script type="text/javascript" src="/lib/jquery/index.js?v=2.1.3"></script>

  
  <script type="text/javascript" src="/lib/fastclick/lib/fastclick.min.js?v=1.0.6"></script>

  
  <script type="text/javascript" src="/lib/jquery_lazyload/jquery.lazyload.js?v=1.9.7"></script>

  
  <script type="text/javascript" src="/lib/velocity/velocity.min.js?v=1.2.1"></script>

  
  <script type="text/javascript" src="/lib/velocity/velocity.ui.min.js?v=1.2.1"></script>

  
  <script type="text/javascript" src="/lib/fancybox/source/jquery.fancybox.pack.js?v=2.1.5"></script>


  


  <script type="text/javascript" src="/js/src/utils.js?v=5.0.1"></script>

  <script type="text/javascript" src="/js/src/motion.js?v=5.0.1"></script>



  
  


  <script type="text/javascript" src="/js/src/affix.js?v=5.0.1"></script>

  <script type="text/javascript" src="/js/src/schemes/pisces.js?v=5.0.1"></script>



  

  


  <script type="text/javascript" src="/js/src/bootstrap.js?v=5.0.1"></script>



  



  



  
  
  

  

  

</body>
</html>
